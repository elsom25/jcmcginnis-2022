<%
  # ════════════════════════════════════════════════════════════════════════════
  # CTA BUTTON
  # ════════════════════════════════════════════════════════════════════════════
  #
  # Primary and secondary call-to-action buttons with icon support.
  # Use for: main page actions, form submissions, navigation CTAs.
  #
  # @param href     [String]  URL target (required)
  # @param label    [String]  Button text (required)
  # @param style    [String]  Visual style: "primary" | "secondary"
  # @param icon     [String]  Icon type: "arrow" | "email" | "external" | nil
  # @param size     [String]  Button size: "default" | "large"
  # @param external [Boolean] Opens in new tab
  #
  # @example Primary with arrow
  #   render "cta_button", href: "/blog/", label: "Read my writing", icon: "arrow"
  #
  # @example Secondary large
  #   render "cta_button", href: "/readme/", label: "README.md", style: "secondary", size: "large"
  #
  # @example External link
  #   render "cta_button", href: "https://...", label: "Get the book", icon: "external", external: true
  #
  # ════════════════════════════════════════════════════════════════════════════

  p = contract(binding,
    href:     nil,
    label:    nil,
    style:    %w[primary secondary],
    icon:     nil,
    size:     %w[default large],
    external: false
  )

  # Fallbacks for required params
  href = p.href || "#"
  label = p.label || "Click me"

  # DESIGN TOKENS
  padding = p.size == "large" ? "px-10 py-5" : "px-8 py-4"
  text_size = p.size == "large" ? "text-lg" : ""
  icon_size = p.size == "large" ? "w-6 h-6" : "w-5 h-5"

  # Style classes
  btn_classes = if p.style == "primary"
    "group inline-flex items-center gap-2 #{padding} bg-stone-900 dark:bg-stone-100 hover:bg-brand-600 dark:hover:bg-brand-500 text-white dark:text-stone-900 dark:hover:text-white font-semibold rounded-full transition-all hover:scale-105 #{text_size}"
  else
    "group inline-flex items-center gap-2 #{padding} border-2 border-stone-300 dark:border-stone-700 hover:border-brand-500 dark:hover:border-brand-500 text-stone-900 dark:text-stone-100 font-semibold rounded-full transition-all #{text_size}"
  end

  external_attrs = p.external ? 'rel="external noopener" target="_blank"' : ''
%>
<a href="<%= href %>" class="<%= btn_classes %>" <%= external_attrs.html_safe %>>
  <% if p.icon == "email" %>
    <svg class="<%= icon_size %>" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
    </svg>
  <% end %>
  <%= label %>
  <% if p.icon == "arrow" %>
    <svg class="<%= icon_size %> group-hover:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M17 8l4 4m0 0l-4 4m4-4H3" />
    </svg>
  <% elsif p.icon == "external" %>
    <svg class="<%= icon_size %>" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
      <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
    </svg>
  <% end %>
</a>
